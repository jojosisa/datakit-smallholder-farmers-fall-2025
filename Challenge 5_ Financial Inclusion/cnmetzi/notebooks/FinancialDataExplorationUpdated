{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 23,
   "id": "3d058e1d-be34-4e69-a098-eec8684e129d",
   "metadata": {},
   "outputs": [],
   "source": [
    "#import libraries\n",
    "import pandas as pd\n",
    "import numpy as np\n",
    "import matplotlib.pyplot as plt\n",
    "import seaborn as sns\n",
    "import nltk\n",
    "from nltk.stem import SnowballStemmer\n",
    "from collections import Counter\n",
    "import regex  \n",
    "import os"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "ab691497-0c36-49b6-a2a9-8a4f32f0062e",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "[nltk_data] Downloading package punkt to\n",
      "[nltk_data]     C:\\Users\\cmetzing\\AppData\\Roaming\\nltk_data...\n",
      "[nltk_data]   Package punkt is already up-to-date!\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "True"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#ensure tokenizer is available\n",
    "nltk.download('punkt')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "3cd57512-606f-494b-8ff1-b5ddfec5a1dc",
   "metadata": {},
   "outputs": [],
   "source": [
    "#increase print limits \n",
    "pd.set_option('display.max_rows', None)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "d14177f7-9c1a-48df-9da0-d6fe9dd0446c",
   "metadata": {},
   "outputs": [],
   "source": [
    "#read data\n",
    "df = pd.read_csv(r'C:/Users/cmetzing/Downloads/b0cd514b-b9cc-4972-a0c2-c91726e6d825.csv')"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "7c06e375-da08-42f7-b687-6ed87a7cf5fa",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>question_id</th>\n",
       "      <th>question_user_id</th>\n",
       "      <th>question_language</th>\n",
       "      <th>question_content</th>\n",
       "      <th>question_topic</th>\n",
       "      <th>question_sent</th>\n",
       "      <th>response_id</th>\n",
       "      <th>response_user_id</th>\n",
       "      <th>response_language</th>\n",
       "      <th>response_content</th>\n",
       "      <th>...</th>\n",
       "      <th>question_user_country_code</th>\n",
       "      <th>question_user_gender</th>\n",
       "      <th>question_user_dob</th>\n",
       "      <th>question_user_created_at</th>\n",
       "      <th>response_user_type</th>\n",
       "      <th>response_user_status</th>\n",
       "      <th>response_user_country_code</th>\n",
       "      <th>response_user_gender</th>\n",
       "      <th>response_user_dob</th>\n",
       "      <th>response_user_created_at</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>3849056</td>\n",
       "      <td>519124</td>\n",
       "      <td>nyn</td>\n",
       "      <td>E ABA WEFARM OFFICES ZABO NIZISHANGWA NKAHI?</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2017-11-22 12:25:03+00</td>\n",
       "      <td>20691011</td>\n",
       "      <td>200868</td>\n",
       "      <td>nyn</td>\n",
       "      <td>E!23 Omubazi Ni Dudu Cipa'</td>\n",
       "      <td>...</td>\n",
       "      <td>ug</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2017-11-18 13:09:11+00</td>\n",
       "      <td>farmer</td>\n",
       "      <td>live</td>\n",
       "      <td>ug</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2017-05-09 09:19:33+00</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>1 rows × 24 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "   question_id  question_user_id question_language  \\\n",
       "0      3849056            519124               nyn   \n",
       "\n",
       "                               question_content question_topic  \\\n",
       "0  E ABA WEFARM OFFICES ZABO NIZISHANGWA NKAHI?            NaN   \n",
       "\n",
       "            question_sent  response_id  response_user_id response_language  \\\n",
       "0  2017-11-22 12:25:03+00     20691011            200868               nyn   \n",
       "\n",
       "             response_content  ... question_user_country_code  \\\n",
       "0  E!23 Omubazi Ni Dudu Cipa'  ...                         ug   \n",
       "\n",
       "  question_user_gender question_user_dob question_user_created_at  \\\n",
       "0                  NaN               NaN   2017-11-18 13:09:11+00   \n",
       "\n",
       "  response_user_type response_user_status response_user_country_code  \\\n",
       "0             farmer                 live                         ug   \n",
       "\n",
       "  response_user_gender response_user_dob response_user_created_at  \n",
       "0                  NaN               NaN   2017-05-09 09:19:33+00  \n",
       "\n",
       "[1 rows x 24 columns]"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#check out data\n",
    "df.head(1)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "de1ef9f2-945e-41a7-a0d7-51e22d8b3731",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "question_id                    int64\n",
       "question_user_id               int64\n",
       "question_language             object\n",
       "question_content              object\n",
       "question_topic                object\n",
       "question_sent                 object\n",
       "response_id                    int64\n",
       "response_user_id               int64\n",
       "response_language             object\n",
       "response_content              object\n",
       "response_topic                object\n",
       "response_sent                 object\n",
       "question_user_type            object\n",
       "question_user_status          object\n",
       "question_user_country_code    object\n",
       "question_user_gender          object\n",
       "question_user_dob             object\n",
       "question_user_created_at      object\n",
       "response_user_type            object\n",
       "response_user_status          object\n",
       "response_user_country_code    object\n",
       "response_user_gender          object\n",
       "response_user_dob             object\n",
       "response_user_created_at      object\n",
       "dtype: object"
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "df.dtypes"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "a4f96a5a-8795-488e-a781-8fdc35e27d68",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "question_language\n",
       "eng    11976781\n",
       "swa     6480848\n",
       "nyn     1157228\n",
       "lug      689986\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#possible language values \n",
    "df['question_language'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "dbb41d99-c650-4a7f-87bd-0048613e6e6a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#extract eng data\n",
    "dfe = df[df['question_language'] == 'eng']"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "af558708-fb24-4274-a006-c9ffdf2362ba",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "question_language\n",
       "eng    11976781\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#confirm extraction \n",
    "dfe['question_language'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "898a4f5f-d1ca-4232-81d4-0554ec03ef96",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>question_id</th>\n",
       "      <th>question_user_id</th>\n",
       "      <th>question_language</th>\n",
       "      <th>question_content</th>\n",
       "      <th>question_topic</th>\n",
       "      <th>question_sent</th>\n",
       "      <th>response_id</th>\n",
       "      <th>response_user_id</th>\n",
       "      <th>response_language</th>\n",
       "      <th>response_content</th>\n",
       "      <th>...</th>\n",
       "      <th>question_user_country_code</th>\n",
       "      <th>question_user_gender</th>\n",
       "      <th>question_user_dob</th>\n",
       "      <th>question_user_created_at</th>\n",
       "      <th>response_user_type</th>\n",
       "      <th>response_user_status</th>\n",
       "      <th>response_user_country_code</th>\n",
       "      <th>response_user_gender</th>\n",
       "      <th>response_user_dob</th>\n",
       "      <th>response_user_created_at</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>3849061</td>\n",
       "      <td>521327</td>\n",
       "      <td>eng</td>\n",
       "      <td>Q this goes to wefarm. is it possible to get f...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2017-11-22 12:25:05+00</td>\n",
       "      <td>4334249</td>\n",
       "      <td>526113</td>\n",
       "      <td>eng</td>\n",
       "      <td>Q1 which stage is marleks last vaccinated</td>\n",
       "      <td>...</td>\n",
       "      <td>ug</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2017-11-20 11:55:48+00</td>\n",
       "      <td>farmer</td>\n",
       "      <td>zombie</td>\n",
       "      <td>ug</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2017-11-22 10:13:03+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>3849084</td>\n",
       "      <td>6642</td>\n",
       "      <td>eng</td>\n",
       "      <td>Q-i have stock rabbit's urine for 5 weeks mash...</td>\n",
       "      <td>rabbit</td>\n",
       "      <td>2017-11-22 12:25:10+00</td>\n",
       "      <td>3852272</td>\n",
       "      <td>35690</td>\n",
       "      <td>eng</td>\n",
       "      <td>Q165#Ksh120</td>\n",
       "      <td>...</td>\n",
       "      <td>ke</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2015-07-28 17:12:04+00</td>\n",
       "      <td>farmer</td>\n",
       "      <td>zombie</td>\n",
       "      <td>ke</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2015-11-14 19:59:19+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>3849098</td>\n",
       "      <td>526375</td>\n",
       "      <td>eng</td>\n",
       "      <td>Q J Have Mi 10000 Can J Start Aproject Of Pout...</td>\n",
       "      <td>poultry</td>\n",
       "      <td>2017-11-22 12:25:12+00</td>\n",
       "      <td>3859675</td>\n",
       "      <td>522795</td>\n",
       "      <td>eng</td>\n",
       "      <td>Q5 10000 is not enough because the materials n...</td>\n",
       "      <td>...</td>\n",
       "      <td>ug</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2017-11-22 12:10:37+00</td>\n",
       "      <td>farmer</td>\n",
       "      <td>zombie</td>\n",
       "      <td>ug</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2017-11-21 07:08:05+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>3849100</td>\n",
       "      <td>237506</td>\n",
       "      <td>eng</td>\n",
       "      <td>WHERE DO I GET SEEDS OF COCONUT?</td>\n",
       "      <td>pig</td>\n",
       "      <td>2017-11-22 12:25:12+00</td>\n",
       "      <td>4263505</td>\n",
       "      <td>412335</td>\n",
       "      <td>eng</td>\n",
       "      <td>Q11:try kisumu ,migori ,homa bay,siaya and any...</td>\n",
       "      <td>...</td>\n",
       "      <td>ke</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2017-06-27 10:45:20+00</td>\n",
       "      <td>farmer</td>\n",
       "      <td>destroyed</td>\n",
       "      <td>ke</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2017-10-03 17:35:12+00</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>17</th>\n",
       "      <td>3849100</td>\n",
       "      <td>237506</td>\n",
       "      <td>eng</td>\n",
       "      <td>WHERE DO I GET SEEDS OF COCONUT?</td>\n",
       "      <td>coconut</td>\n",
       "      <td>2017-11-22 12:25:12+00</td>\n",
       "      <td>3852604</td>\n",
       "      <td>412335</td>\n",
       "      <td>eng</td>\n",
       "      <td>Q11:coast Cereals</td>\n",
       "      <td>...</td>\n",
       "      <td>ke</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2017-06-27 10:45:20+00</td>\n",
       "      <td>farmer</td>\n",
       "      <td>destroyed</td>\n",
       "      <td>ke</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2017-10-03 17:35:12+00</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>5 rows × 24 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "    question_id  question_user_id question_language  \\\n",
       "1       3849061            521327               eng   \n",
       "9       3849084              6642               eng   \n",
       "15      3849098            526375               eng   \n",
       "16      3849100            237506               eng   \n",
       "17      3849100            237506               eng   \n",
       "\n",
       "                                     question_content question_topic  \\\n",
       "1   Q this goes to wefarm. is it possible to get f...            NaN   \n",
       "9   Q-i have stock rabbit's urine for 5 weeks mash...         rabbit   \n",
       "15  Q J Have Mi 10000 Can J Start Aproject Of Pout...        poultry   \n",
       "16                   WHERE DO I GET SEEDS OF COCONUT?            pig   \n",
       "17                   WHERE DO I GET SEEDS OF COCONUT?        coconut   \n",
       "\n",
       "             question_sent  response_id  response_user_id response_language  \\\n",
       "1   2017-11-22 12:25:05+00      4334249            526113               eng   \n",
       "9   2017-11-22 12:25:10+00      3852272             35690               eng   \n",
       "15  2017-11-22 12:25:12+00      3859675            522795               eng   \n",
       "16  2017-11-22 12:25:12+00      4263505            412335               eng   \n",
       "17  2017-11-22 12:25:12+00      3852604            412335               eng   \n",
       "\n",
       "                                     response_content  ...  \\\n",
       "1           Q1 which stage is marleks last vaccinated  ...   \n",
       "9                                         Q165#Ksh120  ...   \n",
       "15  Q5 10000 is not enough because the materials n...  ...   \n",
       "16  Q11:try kisumu ,migori ,homa bay,siaya and any...  ...   \n",
       "17                                  Q11:coast Cereals  ...   \n",
       "\n",
       "   question_user_country_code question_user_gender question_user_dob  \\\n",
       "1                          ug                  NaN               NaN   \n",
       "9                          ke                  NaN               NaN   \n",
       "15                         ug                  NaN               NaN   \n",
       "16                         ke                  NaN               NaN   \n",
       "17                         ke                  NaN               NaN   \n",
       "\n",
       "   question_user_created_at response_user_type response_user_status  \\\n",
       "1    2017-11-20 11:55:48+00             farmer               zombie   \n",
       "9    2015-07-28 17:12:04+00             farmer               zombie   \n",
       "15   2017-11-22 12:10:37+00             farmer               zombie   \n",
       "16   2017-06-27 10:45:20+00             farmer            destroyed   \n",
       "17   2017-06-27 10:45:20+00             farmer            destroyed   \n",
       "\n",
       "   response_user_country_code response_user_gender response_user_dob  \\\n",
       "1                          ug                  NaN               NaN   \n",
       "9                          ke                  NaN               NaN   \n",
       "15                         ug                  NaN               NaN   \n",
       "16                         ke                  NaN               NaN   \n",
       "17                         ke                  NaN               NaN   \n",
       "\n",
       "   response_user_created_at  \n",
       "1    2017-11-22 10:13:03+00  \n",
       "9    2015-11-14 19:59:19+00  \n",
       "15   2017-11-21 07:08:05+00  \n",
       "16   2017-10-03 17:35:12+00  \n",
       "17   2017-10-03 17:35:12+00  \n",
       "\n",
       "[5 rows x 24 columns]"
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dfe.head(5)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "567c602a-4323-424f-b086-ddecdd4b1112",
   "metadata": {},
   "outputs": [],
   "source": [
    "#reduce dataset to extract question since single question may have multiple responses \n",
    "dfe = dfe[[\"question_id\", \"question_user_id\",\"question_content\",\"question_topic\",\"question_sent\",\"question_user_country_code\"]]"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "a59ddf43-c658-48ed-9fe9-e129a8d1f6b8",
   "metadata": {},
   "outputs": [],
   "source": [
    "#keep only one row per unique question\n",
    "dfe = dfe.drop_duplicates(subset=\"question_id\", keep=\"first\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "d0d53599-4295-4c9a-bae1-6b91d5ee9e68",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>question_id</th>\n",
       "      <th>question_user_id</th>\n",
       "      <th>question_content</th>\n",
       "      <th>question_topic</th>\n",
       "      <th>question_sent</th>\n",
       "      <th>question_user_country_code</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>3849061</td>\n",
       "      <td>521327</td>\n",
       "      <td>Q this goes to wefarm. is it possible to get f...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2017-11-22 12:25:05+00</td>\n",
       "      <td>ug</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>3849084</td>\n",
       "      <td>6642</td>\n",
       "      <td>Q-i have stock rabbit's urine for 5 weeks mash...</td>\n",
       "      <td>rabbit</td>\n",
       "      <td>2017-11-22 12:25:10+00</td>\n",
       "      <td>ke</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>3849098</td>\n",
       "      <td>526375</td>\n",
       "      <td>Q J Have Mi 10000 Can J Start Aproject Of Pout...</td>\n",
       "      <td>poultry</td>\n",
       "      <td>2017-11-22 12:25:12+00</td>\n",
       "      <td>ug</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>3849100</td>\n",
       "      <td>237506</td>\n",
       "      <td>WHERE DO I GET SEEDS OF COCONUT?</td>\n",
       "      <td>pig</td>\n",
       "      <td>2017-11-22 12:25:12+00</td>\n",
       "      <td>ke</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>3849129</td>\n",
       "      <td>54426</td>\n",
       "      <td>Q#.Which plant has omega3?</td>\n",
       "      <td>plant</td>\n",
       "      <td>2017-11-22 12:25:16+00</td>\n",
       "      <td>ke</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    question_id  question_user_id  \\\n",
       "1       3849061            521327   \n",
       "9       3849084              6642   \n",
       "15      3849098            526375   \n",
       "16      3849100            237506   \n",
       "23      3849129             54426   \n",
       "\n",
       "                                     question_content question_topic  \\\n",
       "1   Q this goes to wefarm. is it possible to get f...            NaN   \n",
       "9   Q-i have stock rabbit's urine for 5 weeks mash...         rabbit   \n",
       "15  Q J Have Mi 10000 Can J Start Aproject Of Pout...        poultry   \n",
       "16                   WHERE DO I GET SEEDS OF COCONUT?            pig   \n",
       "23                         Q#.Which plant has omega3?          plant   \n",
       "\n",
       "             question_sent question_user_country_code  \n",
       "1   2017-11-22 12:25:05+00                         ug  \n",
       "9   2017-11-22 12:25:10+00                         ke  \n",
       "15  2017-11-22 12:25:12+00                         ug  \n",
       "16  2017-11-22 12:25:12+00                         ke  \n",
       "23  2017-11-22 12:25:16+00                         ke  "
      ]
     },
     "execution_count": 13,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#inspect\n",
    "dfe.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "b32018e5-c9ef-4c11-b49e-04c4f9d88660",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>question_id</th>\n",
       "      <th>question_user_id</th>\n",
       "      <th>question_content</th>\n",
       "      <th>question_topic</th>\n",
       "      <th>question_sent</th>\n",
       "      <th>question_user_country_code</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>count</th>\n",
       "      <td>2.940542e+06</td>\n",
       "      <td>2.940542e+06</td>\n",
       "      <td>2940542</td>\n",
       "      <td>2218544</td>\n",
       "      <td>2940542</td>\n",
       "      <td>2940542</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>unique</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2708132</td>\n",
       "      <td>148</td>\n",
       "      <td>2939086</td>\n",
       "      <td>4</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>top</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>What is crop rotation?</td>\n",
       "      <td>chicken</td>\n",
       "      <td>2018-02-01 17:55:53+00</td>\n",
       "      <td>ke</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>freq</th>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>839</td>\n",
       "      <td>265257</td>\n",
       "      <td>7</td>\n",
       "      <td>1665002</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>mean</th>\n",
       "      <td>2.931697e+07</td>\n",
       "      <td>1.659636e+06</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>std</th>\n",
       "      <td>1.615944e+07</td>\n",
       "      <td>1.009599e+06</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>min</th>\n",
       "      <td>3.849061e+06</td>\n",
       "      <td>7.000000e+00</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>25%</th>\n",
       "      <td>1.533666e+07</td>\n",
       "      <td>8.940460e+05</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>50%</th>\n",
       "      <td>2.762343e+07</td>\n",
       "      <td>1.428648e+06</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>75%</th>\n",
       "      <td>4.305158e+07</td>\n",
       "      <td>2.477375e+06</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>max</th>\n",
       "      <td>5.926151e+07</td>\n",
       "      <td>3.832740e+06</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "      <td>NaN</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         question_id  question_user_id        question_content question_topic  \\\n",
       "count   2.940542e+06      2.940542e+06                 2940542        2218544   \n",
       "unique           NaN               NaN                 2708132            148   \n",
       "top              NaN               NaN  What is crop rotation?        chicken   \n",
       "freq             NaN               NaN                     839         265257   \n",
       "mean    2.931697e+07      1.659636e+06                     NaN            NaN   \n",
       "std     1.615944e+07      1.009599e+06                     NaN            NaN   \n",
       "min     3.849061e+06      7.000000e+00                     NaN            NaN   \n",
       "25%     1.533666e+07      8.940460e+05                     NaN            NaN   \n",
       "50%     2.762343e+07      1.428648e+06                     NaN            NaN   \n",
       "75%     4.305158e+07      2.477375e+06                     NaN            NaN   \n",
       "max     5.926151e+07      3.832740e+06                     NaN            NaN   \n",
       "\n",
       "                 question_sent question_user_country_code  \n",
       "count                  2940542                    2940542  \n",
       "unique                 2939086                          4  \n",
       "top     2018-02-01 17:55:53+00                         ke  \n",
       "freq                         7                    1665002  \n",
       "mean                       NaN                        NaN  \n",
       "std                        NaN                        NaN  \n",
       "min                        NaN                        NaN  \n",
       "25%                        NaN                        NaN  \n",
       "50%                        NaN                        NaN  \n",
       "75%                        NaN                        NaN  \n",
       "max                        NaN                        NaN  "
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dfe.describe(include=\"all\")"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "5de6b48b-d887-47ad-9af8-2010424bfa48",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "question_user_country_code\n",
       "ke    1665002\n",
       "ug    1275419\n",
       "gb        118\n",
       "tz          3\n",
       "Name: count, dtype: int64"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#check countries for where question user\n",
    "dfe['question_user_country_code'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "f2e9301d-d524-4e6b-b593-a3b22bebc233",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "question_id                        0\n",
       "question_user_id                   0\n",
       "question_content                   0\n",
       "question_topic                721998\n",
       "question_sent                      0\n",
       "question_user_country_code         0\n",
       "dtype: int64"
      ]
     },
     "execution_count": 16,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#check for nulls\n",
    "dfe.isnull().sum()  #looks like we are missing question topic a lot"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "60dc70e4-a489-4bbf-a767-79fdbf6d99ff",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/plain": [
       "24.55322862247844"
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "#missing\n",
    "(721998/2940542)*100\t"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "ea811a9e-75c2-489e-a7b0-4f9ed5721007",
   "metadata": {},
   "outputs": [],
   "source": [
    "#check question topics\n",
    "#dfe['question_topic'].value_counts()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "d2adbf49-fda7-4362-8ad2-e3ddf9a74eb6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#basic word stem counting setup\n",
    "stemmer = SnowballStemmer(\"english\")\n",
    "counter = Counter()\n",
    "\n",
    "def process_text(text):\n",
    "    #lowercase and remove non-alphabetic characters\n",
    "    tokens = regex.findall(r'\\b\\w+\\b', str(text).lower())\n",
    "    stems = [stemmer.stem(token) for token in tokens]\n",
    "    return stems"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "eb73ac17-40af-4991-9f22-004aa868c425",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Process each row and update stem counts\n",
    "for row in dfe['question_content']:\n",
    "    stems = process_text(row)\n",
    "    counter.update(stems)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "ad7ea435-a4f0-4ad1-98a7-731989a09027",
   "metadata": {},
   "outputs": [],
   "source": [
    "#counter"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 24,
   "id": "d161b98a-9e0d-4271-bd80-a4377deb409a",
   "metadata": {},
   "outputs": [],
   "source": [
    "#write counts to csv\n",
    "counts = pd.DataFrame(counter.items(), columns=['item', 'count'])\n",
    "counts.to_csv(os.path.join(os.path.dirname(os.getcwd()), 'data', 'allstemcounter_output.csv'), index=False)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 25,
   "id": "ae034019-1bed-4295-8284-e4433a9d864a",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Q In usin-Gishu maize farming as become unprofitable which other crops can u advise the farmers of uasin-gishu to grow\n",
      "q which crop is unprofitable in uganda?\n",
      "s if kept over that age by many weeks they are likely to be unprofitable.the enterprise must be organised to have the contracted number ready for marketi\n",
      "Q what makes layers poultry unprofitable to keep\n",
      "Q what makes layers poultry unprofitable to keep\n",
      "Q A farmer asks: what makes layers poultry unprofitable to keep?\n",
      "Jina asks: A farmer asks: what makes layers poultry unprofitable to keep?\n",
      "Q88:Jina asks: A farmer asks: what makes layers poultry unprofitable to keep?\n"
     ]
    }
   ],
   "source": [
    "#manual inspect specific key stem\n",
    "target_stem = \"unprofit\"\n",
    "matching_questions = []\n",
    "\n",
    "for row in dfe['question_content']:\n",
    "    stems = process_text(row)\n",
    "    if target_stem in stems:\n",
    "        matching_questions.append(row)\n",
    "\n",
    "# Now matching_questions contains all question_contents with the chosen stem\n",
    "for q in matching_questions:\n",
    "    print(q)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 26,
   "id": "b726ce30-b9f8-46a1-9c77-9bcd8c6922f6",
   "metadata": {},
   "outputs": [],
   "source": [
    "#these last 5 questions seems to be others asking the same question on behalf of the original asker not for their own information so we need to address this"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 28,
   "id": "32d98adc-0fda-4643-9313-7f41fc116e77",
   "metadata": {},
   "outputs": [],
   "source": [
    "#load top financial stems selected\n",
    "stemmed_keywords = pd.read_csv(os.path.join(os.path.dirname(os.getcwd()), 'data', 'toppotentialfinancialkeywords.csv'),usecols=[0], skiprows=1, header=None)[0]\n",
    "stemmed_keywords_set = set(stemmed_keywords.astype(str))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "6c6c4391-b4de-4485-9c78-d896a0aa44a4",
   "metadata": {},
   "outputs": [],
   "source": [
    "#stemmed_keywords"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 30,
   "id": "b858547e-c305-46a1-90eb-69c9deebd137",
   "metadata": {},
   "outputs": [],
   "source": [
    "#check for top financial stems\n",
    "\n",
    "def contains_stemmed_keyword(text):\n",
    "    tokens = regex.findall(r'\\b\\w+\\b', str(text).lower())\n",
    "    stems = set(stemmer.stem(token) for token in tokens)\n",
    "    return bool(stems & stemmed_keywords_set)  \n",
    "\n",
    "dfe['contains_financial_word'] = dfe['question_content'].apply(contains_stemmed_keyword)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 31,
   "id": "d52844a0-b8bb-4f55-ae37-a5edeeefc28c",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>question_id</th>\n",
       "      <th>question_user_id</th>\n",
       "      <th>question_content</th>\n",
       "      <th>question_topic</th>\n",
       "      <th>question_sent</th>\n",
       "      <th>question_user_country_code</th>\n",
       "      <th>contains_financial_word</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>3849061</td>\n",
       "      <td>521327</td>\n",
       "      <td>Q this goes to wefarm. is it possible to get f...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2017-11-22 12:25:05+00</td>\n",
       "      <td>ug</td>\n",
       "      <td>True</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>3849084</td>\n",
       "      <td>6642</td>\n",
       "      <td>Q-i have stock rabbit's urine for 5 weeks mash...</td>\n",
       "      <td>rabbit</td>\n",
       "      <td>2017-11-22 12:25:10+00</td>\n",
       "      <td>ke</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>3849098</td>\n",
       "      <td>526375</td>\n",
       "      <td>Q J Have Mi 10000 Can J Start Aproject Of Pout...</td>\n",
       "      <td>poultry</td>\n",
       "      <td>2017-11-22 12:25:12+00</td>\n",
       "      <td>ug</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>3849100</td>\n",
       "      <td>237506</td>\n",
       "      <td>WHERE DO I GET SEEDS OF COCONUT?</td>\n",
       "      <td>pig</td>\n",
       "      <td>2017-11-22 12:25:12+00</td>\n",
       "      <td>ke</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>3849129</td>\n",
       "      <td>54426</td>\n",
       "      <td>Q#.Which plant has omega3?</td>\n",
       "      <td>plant</td>\n",
       "      <td>2017-11-22 12:25:16+00</td>\n",
       "      <td>ke</td>\n",
       "      <td>False</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    question_id  question_user_id  \\\n",
       "1       3849061            521327   \n",
       "9       3849084              6642   \n",
       "15      3849098            526375   \n",
       "16      3849100            237506   \n",
       "23      3849129             54426   \n",
       "\n",
       "                                     question_content question_topic  \\\n",
       "1   Q this goes to wefarm. is it possible to get f...            NaN   \n",
       "9   Q-i have stock rabbit's urine for 5 weeks mash...         rabbit   \n",
       "15  Q J Have Mi 10000 Can J Start Aproject Of Pout...        poultry   \n",
       "16                   WHERE DO I GET SEEDS OF COCONUT?            pig   \n",
       "23                         Q#.Which plant has omega3?          plant   \n",
       "\n",
       "             question_sent question_user_country_code  contains_financial_word  \n",
       "1   2017-11-22 12:25:05+00                         ug                     True  \n",
       "9   2017-11-22 12:25:10+00                         ke                    False  \n",
       "15  2017-11-22 12:25:12+00                         ug                    False  \n",
       "16  2017-11-22 12:25:12+00                         ke                    False  \n",
       "23  2017-11-22 12:25:16+00                         ke                    False  "
      ]
     },
     "execution_count": 31,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dfe.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 34,
   "id": "47416250-0ef7-4a9c-854f-e012e0b603d3",
   "metadata": {},
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "C:\\Users\\cmetzing\\AppData\\Local\\Temp\\ipykernel_136460\\1418378379.py:3: UserWarning: Converting to PeriodArray/Index representation will drop timezone information.\n",
      "  dfe['month'] = dfe['question_sent'].dt.to_period('M').astype(str)\n"
     ]
    }
   ],
   "source": [
    "#Add a month column\n",
    "dfe['question_sent'] = pd.to_datetime(dfe['question_sent'], errors='coerce')\n",
    "dfe['month'] = dfe['question_sent'].dt.to_period('M').astype(str)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 50,
   "id": "fc75b0d1-d246-4d33-acd2-ebd9a472188d",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>question_id</th>\n",
       "      <th>question_user_id</th>\n",
       "      <th>question_content</th>\n",
       "      <th>question_topic</th>\n",
       "      <th>question_sent</th>\n",
       "      <th>question_user_country_code</th>\n",
       "      <th>contains_financial_word</th>\n",
       "      <th>month</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>3849061</td>\n",
       "      <td>521327</td>\n",
       "      <td>Q this goes to wefarm. is it possible to get f...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2017-11-22 12:25:05+00:00</td>\n",
       "      <td>ug</td>\n",
       "      <td>True</td>\n",
       "      <td>2017-11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>9</th>\n",
       "      <td>3849084</td>\n",
       "      <td>6642</td>\n",
       "      <td>Q-i have stock rabbit's urine for 5 weeks mash...</td>\n",
       "      <td>rabbit</td>\n",
       "      <td>2017-11-22 12:25:10+00:00</td>\n",
       "      <td>ke</td>\n",
       "      <td>False</td>\n",
       "      <td>2017-11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>15</th>\n",
       "      <td>3849098</td>\n",
       "      <td>526375</td>\n",
       "      <td>Q J Have Mi 10000 Can J Start Aproject Of Pout...</td>\n",
       "      <td>poultry</td>\n",
       "      <td>2017-11-22 12:25:12+00:00</td>\n",
       "      <td>ug</td>\n",
       "      <td>False</td>\n",
       "      <td>2017-11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>16</th>\n",
       "      <td>3849100</td>\n",
       "      <td>237506</td>\n",
       "      <td>WHERE DO I GET SEEDS OF COCONUT?</td>\n",
       "      <td>pig</td>\n",
       "      <td>2017-11-22 12:25:12+00:00</td>\n",
       "      <td>ke</td>\n",
       "      <td>False</td>\n",
       "      <td>2017-11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>23</th>\n",
       "      <td>3849129</td>\n",
       "      <td>54426</td>\n",
       "      <td>Q#.Which plant has omega3?</td>\n",
       "      <td>plant</td>\n",
       "      <td>2017-11-22 12:25:16+00:00</td>\n",
       "      <td>ke</td>\n",
       "      <td>False</td>\n",
       "      <td>2017-11</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    question_id  question_user_id  \\\n",
       "1       3849061            521327   \n",
       "9       3849084              6642   \n",
       "15      3849098            526375   \n",
       "16      3849100            237506   \n",
       "23      3849129             54426   \n",
       "\n",
       "                                     question_content question_topic  \\\n",
       "1   Q this goes to wefarm. is it possible to get f...            NaN   \n",
       "9   Q-i have stock rabbit's urine for 5 weeks mash...         rabbit   \n",
       "15  Q J Have Mi 10000 Can J Start Aproject Of Pout...        poultry   \n",
       "16                   WHERE DO I GET SEEDS OF COCONUT?            pig   \n",
       "23                         Q#.Which plant has omega3?          plant   \n",
       "\n",
       "               question_sent question_user_country_code  \\\n",
       "1  2017-11-22 12:25:05+00:00                         ug   \n",
       "9  2017-11-22 12:25:10+00:00                         ke   \n",
       "15 2017-11-22 12:25:12+00:00                         ug   \n",
       "16 2017-11-22 12:25:12+00:00                         ke   \n",
       "23 2017-11-22 12:25:16+00:00                         ke   \n",
       "\n",
       "    contains_financial_word    month  \n",
       "1                      True  2017-11  \n",
       "9                     False  2017-11  \n",
       "15                    False  2017-11  \n",
       "16                    False  2017-11  \n",
       "23                    False  2017-11  "
      ]
     },
     "execution_count": 50,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dfe.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 51,
   "id": "c7885a95-dc2e-475e-8761-4a9f6b235c61",
   "metadata": {},
   "outputs": [],
   "source": [
    "dfef =  dfe[dfe['contains_financial_word'] == True].copy()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 52,
   "id": "febd9248-7d4d-4659-ab5f-c17483e1b2a8",
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>question_id</th>\n",
       "      <th>question_user_id</th>\n",
       "      <th>question_content</th>\n",
       "      <th>question_topic</th>\n",
       "      <th>question_sent</th>\n",
       "      <th>question_user_country_code</th>\n",
       "      <th>contains_financial_word</th>\n",
       "      <th>month</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>3849061</td>\n",
       "      <td>521327</td>\n",
       "      <td>Q this goes to wefarm. is it possible to get f...</td>\n",
       "      <td>NaN</td>\n",
       "      <td>2017-11-22 12:25:05+00:00</td>\n",
       "      <td>ug</td>\n",
       "      <td>True</td>\n",
       "      <td>2017-11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>26</th>\n",
       "      <td>3849153</td>\n",
       "      <td>340091</td>\n",
       "      <td>Q Am Jackson From Ibanda If Want To Grow Tomat...</td>\n",
       "      <td>tomato</td>\n",
       "      <td>2017-11-22 12:25:18+00:00</td>\n",
       "      <td>ug</td>\n",
       "      <td>True</td>\n",
       "      <td>2017-11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>47</th>\n",
       "      <td>3849285</td>\n",
       "      <td>262078</td>\n",
       "      <td>Q.How much is price of 1kg of onions farmgate ...</td>\n",
       "      <td>onion</td>\n",
       "      <td>2017-11-22 12:34:40+00:00</td>\n",
       "      <td>ke</td>\n",
       "      <td>True</td>\n",
       "      <td>2017-11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>156</th>\n",
       "      <td>3849758</td>\n",
       "      <td>522802</td>\n",
       "      <td>Q why is the price of maize low this days</td>\n",
       "      <td>maize</td>\n",
       "      <td>2017-11-22 13:15:35+00:00</td>\n",
       "      <td>ug</td>\n",
       "      <td>True</td>\n",
       "      <td>2017-11</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>159</th>\n",
       "      <td>3849788</td>\n",
       "      <td>522802</td>\n",
       "      <td>Qwhat is the exact  price of a kilo gram of ma...</td>\n",
       "      <td>maize</td>\n",
       "      <td>2017-11-22 13:19:13+00:00</td>\n",
       "      <td>ug</td>\n",
       "      <td>True</td>\n",
       "      <td>2017-11</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "     question_id  question_user_id  \\\n",
       "1        3849061            521327   \n",
       "26       3849153            340091   \n",
       "47       3849285            262078   \n",
       "156      3849758            522802   \n",
       "159      3849788            522802   \n",
       "\n",
       "                                      question_content question_topic  \\\n",
       "1    Q this goes to wefarm. is it possible to get f...            NaN   \n",
       "26   Q Am Jackson From Ibanda If Want To Grow Tomat...         tomato   \n",
       "47   Q.How much is price of 1kg of onions farmgate ...          onion   \n",
       "156          Q why is the price of maize low this days          maize   \n",
       "159  Qwhat is the exact  price of a kilo gram of ma...          maize   \n",
       "\n",
       "                question_sent question_user_country_code  \\\n",
       "1   2017-11-22 12:25:05+00:00                         ug   \n",
       "26  2017-11-22 12:25:18+00:00                         ug   \n",
       "47  2017-11-22 12:34:40+00:00                         ke   \n",
       "156 2017-11-22 13:15:35+00:00                         ug   \n",
       "159 2017-11-22 13:19:13+00:00                         ug   \n",
       "\n",
       "     contains_financial_word    month  \n",
       "1                       True  2017-11  \n",
       "26                      True  2017-11  \n",
       "47                      True  2017-11  \n",
       "156                     True  2017-11  \n",
       "159                     True  2017-11  "
      ]
     },
     "execution_count": 52,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "dfef.head()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 53,
   "id": "c3a71b01-fdef-4c32-8c38-7f4aa16af23e",
   "metadata": {},
   "outputs": [],
   "source": [
    "# Ensure pandas copy on write is enabled\n",
    "pd.options.mode.copy_on_write = True\n",
    "\n",
    "# Calculate totals\n",
    "total_questions = len(dfe)\n",
    "financial_questions = len(dfef)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 57,
   "id": "ca812465-2deb-4d19-a245-636e13a97b1b",
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "291920\n",
      "2940542\n"
     ]
    }
   ],
   "source": [
    "print(financial_questions)\n",
    "print(total_questions)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "id": "693e2aa8-7f3c-470b-9d57-45f874313765",
   "metadata": {},
   "outputs": [],
   "source": []
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "Python 3 (ipykernel)",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.7"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
